<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dirigo Sea Farm Cost Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
  <div class="p-6 max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">Dirigo Sea Farm Cost Dashboard</h1>

    <!-- Levers -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
      <div>
        <label class="block mb-2 font-semibold">Seaweed Price ($/lb)</label>
        <input type="range" id="seaweedPrice" min="2" max="15" step="0.25" value="8" class="w-full">
        <div>$<span id="seaweedPriceValue">8.00</span></div>
      </div>
      <div>
        <label class="block mb-2 font-semibold">Alginate Yield (%)</label>
        <input type="range" id="alginateYield" min="5" max="25" step="0.5" value="12" class="w-full">
        <div><span id="alginateYieldValue">12</span>%</div>
      </div>
      <div>
        <label class="block mb-2 font-semibold">Ethanol Recovery (%)</label>
        <input type="range" id="ethanolRecovery" min="0" max="95" step="5" value="0" class="w-full">
        <div><span id="ethanolRecoveryValue">0</span>%</div>
      </div>
      <div>
        <label class="block mb-2 font-semibold">Seaweed Quantity (lbs)</label>
        <input type="range" id="seaweedQuantity" min="1" max="20" step="0.5" value="6" class="w-full">
        <div><span id="seaweedQuantityValue">6</span> lbs</div>
      </div>
      <div>
        <label class="block mb-2 font-semibold">Microalgae Cost ($/lb)</label>
        <input type="range" id="microalgaeCost" min="0.25" max="5" step="0.25" value="1" class="w-full">
        <div>$<span id="microalgaeCostValue">1.00</span></div>
      </div>
      <div>
        <label class="block mb-2 font-semibold">Macroalgae % of Blend</label>
        <input type="range" id="macroPct" min="0" max="100" step="5" value="100" class="w-full">
        <div><span id="macroPctValue">100</span>%</div>
      </div>
    </div>

    <!-- Outputs -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="bg-white p-4 rounded shadow">
        <h2 class="font-bold text-lg mb-2">Sodium Alginate COG</h2>
        <div class="text-2xl text-blue-600">$<span id="sodiumAlginateCOG">0.00</span>/lb</div>
      </div>
      <div class="bg-white p-4 rounded shadow">
        <h2 class="font-bold text-lg mb-2">Blended Resin COG</h2>
        <div class="text-2xl text-green-600">$<span id="blendedResinCOG">0.00</span>/lb</div>
      </div>
    </div>
  </div>

  <script>
    const sodiumBicarbPrice = 1.00;
    const sodiumBicarbQuantity = 1.98;
    const ethanolQuantity = 0.462301;
    const baseEthanolPrice = 71.98;
    const glycerolPrice = 1.03;
    const glycerolUtilization = 0.6;

    function calculateAll() {
      const seaweedPrice = parseFloat(document.getElementById('seaweedPrice').value);
      const alginateYield = parseFloat(document.getElementById('alginateYield').value);
      const ethanolRecovery = parseFloat(document.getElementById('ethanolRecovery').value);
      const seaweedQuantity = parseFloat(document.getElementById('seaweedQuantity').value);
      const microalgaeCost = parseFloat(document.getElementById('microalgaeCost').value);
      const macroPct = parseFloat(document.getElementById('macroPct').value) / 100;
      const microPct = 1 - macroPct;

      // Update slider display values
      document.getElementById('seaweedPriceValue').textContent = seaweedPrice.toFixed(2);
      document.getElementById('alginateYieldValue').textContent = alginateYield;
      document.getElementById('ethanolRecoveryValue').textContent = ethanolRecovery;
      document.getElementById('seaweedQuantityValue').textContent = seaweedQuantity;
      document.getElementById('microalgaeCostValue').textContent = microalgaeCost.toFixed(2);
      document.getElementById('macroPctValue').textContent = (macroPct * 100).toFixed(0);

      const effectiveEthanolPrice = baseEthanolPrice * (1 - ethanolRecovery / 100);
      const ethanolCost = ethanolQuantity * effectiveEthanolPrice;
      const kelpCost = seaweedQuantity * seaweedPrice;
      const sodiumBicarbCost = sodiumBicarbQuantity * sodiumBicarbPrice;

      const alginateLbs = seaweedQuantity * (alginateYield / 100);
      const totalRawCost = kelpCost + sodiumBicarbCost + ethanolCost;
      const sodiumAlginatePerLb = totalRawCost / alginateLbs;

      // Final sodium alginate cost per lb (for macro calculation)
      const sodiumAlginateCOG = sodiumAlginatePerLb;
      document.getElementById('sodiumAlginateCOG').textContent = sodiumAlginateCOG.toFixed(2);

      // Macro input = alginate + glycerol cost
      const macroInputCOG = sodiumAlginateCOG + (glycerolUtilization * glycerolPrice);

      const blendedResinCOG = (macroPct * macroInputCOG) + (microPct * microalgaeCost);
      document.getElementById('blendedResinCOG').textContent = blendedResinCOG.toFixed(2);
    }

    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('input', calculateAll);
    });

    calculateAll();
  </script>
</body>
</html>
